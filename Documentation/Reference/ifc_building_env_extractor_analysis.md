# IFC_BuildingEnvExtractor — обзор и адаптация

> Примечание: репозиторий `tudelft3d/IFC_BuildingEnvExtractor` недоступен из текущей среды (HTTP 403). Анализ основан на публичном описании задачи и типичных подходах обработки IFC и построения оболочек зданий. При появлении доступа требуется сверка с исходным кодом и уточнение деталей.

## Архитектура решения (типовой паттерн)

1. **Загрузка IFC** через `ifcopenshell.open`.
2. **Отбор категорий** элементов оболочки (стены, крыши, перекрытия, витражные фасады).
3. **Тесселяция геометрии** в триангулированные меши (`ifcopenshell.geom`).
4. **Агрегация мешей** в единый меш оболочки.
5. **Извлечение внешней оболочки** через один из методов:
   - Voxelization + Marching Cubes (устойчивый, управляемая детализация).
   - Convex Hull (быстро, но потеря формы).
   - Alpha Shape (компромисс между скоростью и точностью).
6. **Пост‑обработка**: удаление дыр, нормализация нормалей, упрощение, масштабирование.
7. **Экспорт**: сохранение меша в форматах STL/OBJ/FBX.

## Ключевые функции и классы (ожидаемые)

- **IFC loader**: загрузка IFC и фильтрация по типам.
- **Mesh builder**: построение `trimesh.Trimesh` из `ifcopenshell.geom`.
- **Envelope extractor**: алгоритм оболочки (voxel / alpha / convex hull).
- **Mesh repair**: устранение дыр, инвертированных нормалей, самопересечений.
- **Exporter**: сериализация результата.

## Алгоритмы (ожидаемая база)

| Алгоритм | Описание | Плюсы | Минусы |
| --- | --- | --- | --- |
| Voxelization + Marching Cubes | Дискретизация в воксели и восстановление поверхности | Устойчивость к шуму и дыркам | Требует подбора шага, возможна потеря деталей |
| Convex Hull | Выпуклая оболочка | Очень быстро | Искажает форму, теряет ниши |
| Alpha Shape | Контроль детализации оболочки | Точность выше convex hull | Требует подбора alpha |

## Что можно переиспользовать напрямую

- Логику извлечения геометрии через `ifcopenshell.geom`.
- Пост‑процессинг меша: очистка, устранение дыр, нормализация.
- Экспорт в стандартизированные форматы.

## Что нужно адаптировать для 3D‑печати

- **Контроль масштаба** под габариты принтера (Bambu Lab H2S 450×450×450 мм).
- **Упрощение геометрии** с сохранением формы (decimation).
- **Гарантия водонепроницаемости**: закрытие отверстий, исправление нормалей.
- **Минимальная толщина стенок** и корректность для слайсера.
- **Логирование и валидация** перед экспортом.

## План сверки после восстановления доступа

1. Снять список зависимостей и основных модулей.
2. Зафиксировать точные параметры алгоритма оболочки.
3. Сравнить входные/выходные форматы.
4. Обновить текущую реализацию и документ.
